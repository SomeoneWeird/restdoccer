<%
	
	var replacer = function(match, pIndent, pKey, pVal, pEnd) {
      var key = '<span class=json-key>';
      var val = '<span class=json-value>';
      var str = '<span class=json-string>';
      var r = pIndent || '';
      if (pKey)
         r = r + key + pKey.replace(/[": ]/g, '') + '</span>: ';
      if (pVal)
         r = r + (pVal[0] == '"' ? str : val) + pVal + '</span>';
      return r + (pEnd || '');
    }
    var prettyPrint = function(obj) {
      var jsonLine = /^( *)("[\w]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/mg;
      return JSON.stringify(obj, null, 3)
         .replace(/&/g, '&amp;').replace(/\\"/g, '&quot;')
         .replace(/</g, '&lt;').replace(/>/g, '&gt;')
         .replace(jsonLine, replacer);
    }

%>

<div class="accordion-group">
				
  	<div class="accordion-heading">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse-<%=api.index%>">
          	<% 

      			var method = api.method; 

				var badge = 'label-default';

      			if(method == "GET") {

      				badge = 'label-success';

      			} else if(method == "POST") {

      				badge = 'label-info';

      			} else if(method == "DELETE") {

      				badge = 'label-danger';

      			}

          	%>

          	<span class="label <%= badge %>"><%= method %></span>

          	<%= api.endpoint %>

          	<% 

          		if(api.tags && api.tags.length > 0) { 

          			for(var j = 0; j < api.tags.length; j++) {

          	%>

          			<span class="label label-default pull-right"><%= api.tags[j] %></span>

          	<% 		

          			}

          		}

          	%>

          	<% if(api.experimental) { %>
          		<span class="label label-warning pull-right">experimental</span>
          	<% } %>

          	<% if(api.development) { %>
          		<span class="label label-important pull-right">development</span>
          	<% } %>

        </a>
  	</div>

  	<div id="collapse-<%=api.index%>" class="accordion-body collapse">
    	<div class="accordion-inner">

    		<div class="page-header">
			  <h1><%= api.endpoint %> <br>
			  <small><%= api.description || '' %></small></h1>
			</div>

			<% if(api.deprecated) { %>

				<div class="alert">
				  <button type="button" class="close" data-dismiss="alert">&times;</button>
				  <strong>Warning!</strong> This endpoint has been deprecated.
				</div>

			<% } %>

			<% if(api.experimental) { %>

				<div class="alert alert-info">
					This API is experimental.
				</div>

			<% } %>

			<% if(api.development) { %>

				<div class="alert alert-warning">
					This API is under development.
				</div>

			<% } %>

        	<% if((api.urlParameters && Object.keys(api.urlParameters).length > 0) || (api.postParameters && Object.keys(api.postParameters).length > 0)) { %>


        		<div class="accordion" id="accordion-params">

            		<% 

            			var urlParameters = api.urlParameters;

            			if(urlParameters && Object.keys(urlParameters).length > 0) { 

            		%>

						<div class="accordion-group">
					
		                  	<div class="accordion-heading">
			                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-params" href="#collapse-<%=api.index%>-urlparams">Required URL Parameters</a>
                  			</div>

		                  	<div id="collapse-<%=api.index%>-urlparams" class="accordion-body collapse">
		                    	<div class="accordion-inner">

									<table class="table table-striped">
										<thead>
											<tr>
											<th>Key</th>
											<th>Type</th>
											<th>Required</th>
											<th>Description</th>
											</tr>
										</thead>
										<tbody>

											<% for(var key in urlParameters) { 

													var keyData = urlParameters[key]

											%>

												<tr>
													<td><%=key%></td>
													<td><%=keyData.type || "Unspecified" %></td>
													<td><%=keyData.required || false %></td>
													<td><%=keyData.description || "" %></td>
												</tr>

											<% } %>

										</tbody>

									</table>

								</div>

							</div>

						</div>

        			<% } else { %>

        				<div class="accordion-group">
					
		                  	<div class="accordion-heading">
			                    <span class="accordion-toggle">
			                    	No required URL Parameters
			                    </span>
                  			</div>

                  		</div>

                  	<% } %>

            		<% 

            			var postParameters = api.postParameters;

            			if(postParameters && Object.keys(postParameters).length > 0) {

            		%>

        				<div class="accordion-group">
					
		                  	<div class="accordion-heading">
			                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-params" href="#collapse-<%=api.index%>-postparams">Required POST Parameters</a>
                  			</div>

                  			<div id="collapse-<%=api.index%>-postparams" class="accordion-body collapse ">

		                    	<div class="accordion-inner">

									<table class="table table-striped">
										<thead>
											<tr>
											<th>Key</th>
											<th>Type</th>
											<th>Required</th>
											<th>Description</th>
											</tr>
										</thead>
										<tbody>

											<% for(var key in postParameters) { 

													var keyData = postParameters[key]

											%>

												<tr>
													<td><%=key%></td>
													<td><%=keyData.type || "Unspecified" %></td>
													<td><%=keyData.required || false %></td>
													<td><%=keyData.description || "" %></td>
												</tr>

											<% } %>

										</tbody>
									</table>

								</div>

							</div>

						</div>

    				<% } else { %>

    					<div class="accordion-group">
					
		                  	<div class="accordion-heading">
			                    <span class="accordion-toggle">
			                    	No required POST Parameters
			                    </span>
                  			</div>

                  		</div>

                  	<% } %>

        		</div>

            <% } %>

        	<br>

        	<% if(api.responses && api.responses.success !== undefined) { %>

            	<div style="width: 50%; float: left;">

        			<h5><span class="label label-success">Successful Response</span></h5>

        			<% if(api.responses.success_msg) { %>

        				<h6><%=api.responses.success_msg %></h6>

        			<% } %>


        			<pre><%- prettyPrint(api.responses.success) %></pre>

        		</div>

        	<% } %>

        	<% if(api.responses && api.responses.error !== undefined) { %>

        		<div style="width: 50%; float: right;">

        			<h5><span class="label label-important">Response on error</span></h5>	                    			
        			<% if(api.responses.error_msg) { %>

        				<h6><%- api.responses.error_msg %></h6>

        			<% } %>

        			<pre><%- prettyPrint(api.responses.error) %></pre>

        		</div>

        	<% } %>

		</div>

  	</div>

</div>